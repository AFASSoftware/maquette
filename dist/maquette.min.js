!function(e){"use strict";var t=!1,r=function(){},n=[],o=function(e,t){var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),t&&Object.keys(t).forEach(function(e){r[e]=t[e]}),r},i=function(e,t,r,n,o){for(var s=0;s<t.length;s++){var l=t[s];Array.isArray(l)?n=i(e,l,r,n,o):null!==l&&void 0!==l&&(l.hasOwnProperty("vnodeSelector")?d(e,l,o):l=a(l),r.splice(n,0,l),n++)}return n},d=function(e,r,n){if(!t){var o=r.vnodeSelector;if(!(""===o||r.properties&&r.properties.key)){for(var i=0;i<n.length;i++)if(o===n[i])throw new Error("["+e+"] contains undistinguishable child nodes ["+o+"], please add unique key properties.");n.push(o)}}},a=function(e){return{vnodeSelector:"",text:null===e||void 0===e?"":e.toString(),domNode:null}},s=function(e,t){if(null===t||void 0===t)return null;if(!Array.isArray(t))return t.hasOwnProperty("vnodeSelector")?[t]:[a(t)];for(var r=0,n=[];r<t.length;){var o=t[r];null===o||void 0===o?t.splice(r,1):Array.isArray(o)?(t.splice(r,1),r=i(e,o,t,r,n)):o.hasOwnProperty("vnodeSelector")?(d(e,o,n),r++):(t[r]=a(o),r++)}return t},l=/([\.#]?[a-zA-Z0-9_:-]+)/,u={nodeToRemove:function(e){e.parentNode.removeChild(e)},nodeAdded:function(){},nodeUpdated:function(){}},c={namespace:null,transitions:u},p=function(e){return o(c,e)},f=function(e,t,r){if(t){var n=r.eventHandlerInterceptor;for(var o in t){var i=t[o];if("class"===o||"className"===o||"classList"===o)throw new Error("Not supported, use 'classes' instead.");if("classes"===o)for(var d in i)i[d]&&e.classList.add(d);else{if("key"===o)continue;if(null===i||void 0===i)continue;var a=typeof i;"function"===a?(n&&(i=n(o,i,e)),e[o]=i):"string"===a?e.setAttribute(o,i):e[o]=i}}}},v=function(e,t,r,n){if(r){var o=n.transitions;for(var i in r){var d=r[i],a=t[i];if("classes"===i){if(d===a)continue;var s=e.classList;for(var l in d){var u=!!d[l],c=!!a[l];u!==c&&(u?(s.add(l),o.nodeUpdated(e,"addClass",l,void 0,void 0)):(s.remove(l),o.nodeUpdated(e,"removeClass",l,void 0,void 0)))}}else if(d||"string"!=typeof a||(d=""),"value"===i)e[i]!==d&&(e[i]=d),d!==a&&o.nodeUpdated(e,"property",i,d,a);else if(d!==a){var p=typeof d;if("function"===p)throw new Error("Functions may not be updated on subsequent renders (property: "+i+")");"string"===p?e.setAttribute(i,d):e[i]=d,o.nodeUpdated(e,"property",i,d,a)}}}},m=function(e,t,r){t&&t.forEach(function(t){g(t,function(t){e.appendChild(t)},r)})},h=function(e,t){return e.vnodeSelector!==t.vnodeSelector?!1:e.properties&&t.properties?e.properties.key===t.properties.key:!e.properties&&!t.properties},y=function(e,t,r){if(""!==t.vnodeSelector)for(var n=r;n<e.length;n++)if(h(e[n],t))return n;return-1},w=function(e,t,r,o){if(t!==r){t=t||n,r=r||n;for(var i,d=o.transitions,a=0,s=0,l=function(r){if(a<t.length){var n=t[a];e.insertBefore(r,n.domNode)}else e.appendChild(r)};s<r.length;){var u=a<t.length?t[a]:null,c=r[s];if(u&&h(u,c))S(u,c,o),a++;else{var p=y(t,c,a+1);if(p>=0){for(i=a;p>i;i++)d.nodeToRemove(t[i].domNode,t[i].properties);S(t[p],c,o),a=p+1}else g(c,l,o),d.nodeAdded(c.domNode,c.properties)}s++}if(t.length>a)for(i=a;i<t.length;i++)d.nodeToRemove(t[i].domNode,t[i].properties)}},g=function(e,t,r){if(""===e.vnodeSelector)e.domNode=document.createTextNode(e.text),t(e.domNode);else{var n,i,d,a,s=e.vnodeSelector.split(l);for(d=0;d<s.length;d++)i=s[d],i&&(a=i.charAt(0),n?"."===a?n.classList.add(i.substring(1)):"#"===a&&(n.id=i.substr(1)):("svg"===i&&(r=o(r,{namespace:"http://www.w3.org/2000/svg"})),n=e.domNode=r.namespace?document.createElementNS(r.namespace,i):document.createElement(i),t(n)));N(n,e,r)}},N=function(e,t,r){f(e,t.properties,r),m(e,t.children,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate(e,r,t.vnodeSelector,t.properties,t.children)},S=function(e,t,r){var n=e.domNode;if(!n)throw new Error("previous node was not mounted");e!==t&&(""===t.vnodeSelector?t.text!==e.text&&(n.nodeValue=t.text,r.transitions.nodeUpdated(n,"text",void 0,t.text,e.text)):(v(n,e.properties,t.properties,r),w(n,e.children,t.children,r),t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate(n,r,t.vnodeSelector,t.properties,t.children)),t.domNode=e.domNode)},A=e.performance||{offset:new Date,now:function(){return new Date-this.offset}},x={lastCreateVDom:null,lastCreateDom:null,lastUpdateVDom:null,lastUpdateDom:null,lastProjector:null,createExecuted:function(e,t,r,n){x.lastProjector=n,x.lastCreateVDom=t-e,x.lastCreateDom=r-t},updateExecuted:function(e,t,r,n){x.lastProjector=n,x.lastUpdateVDom=t-e,x.lastUpdateDom=r-t}},D=function(e,t){return{update:function(r){if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using mergeDom with one extra level)");S(e,r,t),e=r},domNode:e.domNode}},C={h:function(e,t,r){return!r&&("string"==typeof t||Array.isArray(t)||t&&t.hasOwnProperty("vnodeSelector"))&&(r=t,t=null),r=s(e,r),{vnodeSelector:e,properties:t,children:r,domNode:null}},createDom:function(e,t){return t=p(t),g(e,r,t),D(e,t)},appendToDom:function(e,t,r){r=p(r);var n=e.appendChild?function(t){e.appendChild(t)}:e;return g(t,n,r),D(t,r)},mergeDom:function(e,t,r){return r=p(r),t.domNode=e,N(e,t,r),D(t,r)},createProjector:function(e,t,r){r=p(r),r.eventHandlerInterceptor=function(e,t){return function(){return a.scheduleRender(),t.apply(this,arguments)}};var n,o=null,i=!1,d=function(){if(n=null,o){var i=A.now(),d=t(),s=A.now();o.update(d),x.updateExecuted(i,s,A.now(),a)}else{var l=A.now(),u=t(),c=A.now();o=C.mergeDom(e,u,r),x.createExecuted(l,c,A.now(),a)}};n=requestAnimationFrame(d);var a={scheduleRender:function(){n||i||(n=requestAnimationFrame(d))},destroy:function(){n&&(cancelAnimationFrame(n),n=null),i=!0}};return a},createCache:function(){var e=null,t=null,r={invalidate:function(){t=null,e=null},result:function(r,n){if(e)for(var o=0;o<r.length;o++)e[o]!==r[o]&&(t=null);return t||(t=n(),e=r),t}};return r},stats:x};C.renderLoop=C.createProjector,"undefined"!=typeof module&&module.exports?module.exports=C:"function"==typeof define&&define.amd?define(function(){return C}):window.maquette=C}(this);