---
---
<!doctype html>
<html>
  <head>
    <title>Tutorial</title>
    <link href="../style.css" rel="stylesheet" />
    <link href="tutorial.css" rel="stylesheet" />
    <script src="http://cdnjs.cloudflare.com/ajax/libs/maquette/{{ site.maquette_version }}/maquette.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.2/velocity.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.8/ace.js"></script>
    <script src="components/markup-matcher.js"></script>
    <script src="components/workbench.js"></script>
    <script src="components/next-button.js"></script>
    <script>
    
      var createEnhancer = function(rootNode) {
        var parameters = [];
        var renderFunctions = [];
        var projections = [];
        
        var afterCreate = function(domNode, projectionOptions) {
          var nodes = rootNode.querySelectorAll("script[type='text/hyperscript']");
          var functionParameters = ["maquette", "h", "projector"];
          var parameterValues = [maquette, maquette.h, projector];
          parameters.forEach(function(p) {
            functionParameters.push(p.name);
            parameterValues.push(p.value);
          });
          Array.prototype.forEach.call(nodes, function(node, i) {
            var func = new Function(functionParameters, "return " + node.textContent.trim());
            var renderFunction = function() {
              return func.apply(undefined, parameterValues); 
            }
            projections.push(maquette.mergeDom(node.parentNode, renderFunction(), projectionOptions));
            renderFunctions.push(renderFunction);
          });
        };
        
        var afterUpdate = function() {
          for (var i=0;i<projections.length;i++) {
            projections[i].update(renderFunctions[i]());
          }
        };
        
        var start = function() {
          return maquette.h("body", {afterCreate: afterCreate, afterUpdate: afterUpdate});
        };
        var projector = maquette.createProjector(rootNode || document.body, start, {});
        
        return {
          projector: projector,
          setParameter: function(name, value) {
            parameters.push({name: name, value: value});
          },
          evaluateScripts: function(rootNode, scriptParameters) {
            
          },
          merge: function(domNode, renderMaquetteFunction) {
            
          },
          append: function(domNode, renderMaquetteFunction) {
            
          }
        };
      };
      
      document.addEventListener('DOMContentLoaded', function () {

        var h = maquette.h;
        var enhancer = createEnhancer(document.body);

        var markupMatcher = window.createMarkupMatcher(enhancer.projector, '<div class="landscape">\n  <div class="saucer">Flying saucer</div>\n</div>');

        var workbench = createWorkbench(enhancer.projector, "assets/saucer-intro.js", [
          markupMatcher
        ]);
        var nextButton = window.createNextButton(enhancer.projector, workbench.allObjectivesAchieved);

        enhancer.evaluateScripts({workbench:workbench});
        enhancer.merge(document.getElementById("next"), nextButton.renderMaquette);

      });
    </script>
  </head>
<body>

  <div class="navbar-fixed">
    <nav class="light-blue lighten-1" role="navigation">
      <div class="nav-wrapper container">
        <a id="logo-container" href="/" class="brand-logo">Maquette - Tutorial</a>
        <ul class="right">
          <li><a href="index.html">Index</a></li>
          <li>
            <a id="next" href="02-variables-and-properties.html">Next</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>

  <div class="instructions container">
    <p>
      In this tutorial we will make you familliar with the virtual DOM technique and the maquette library.
      The application we are building in this tutorial is a remote control for a flying saucer.
      This tutorial is made for people who are familiar with HTML and Javascript.
    </p>

    <h5>
      Get started
    </h5>
    <p>
      In this first exercise you will create the flying saucer we are going to control.
      Thanks to some alien piece of CSS, all that is needed to create the the flying saucer is the following markup:
      <code>&lt;div class="saucer" /&gt;</code>
    </p>
    <p>
      Because maquette allows you to make the browser DOM reflect the onderlying data, it does not use HTML.
      Maquette uses a notation called 'hyperscript'.
      This is essentially just a javascript function which returns a tree of virtual DOM nodes.
    </p>
    <p>
      Virtual DOM nodes are created using the <code>h()</code> function.
      The first parameter of this function is a CSS selector string, like <code>"div.landscape"</code>,
      which results in <code>&lt;div class="landscape"&gt;</code>.
      The last parameter is an array of contents. This may contain strings for text and virtual DOM nodes for childnodes.
    </p>

    <p>
      In the workbench below you can edit the sourcefiles for this exercise.
      In order to create the flying saucer, you need to complement the <code>renderMaquette()</code> function.
      In the top-right of the workbench you can see your progress. 
      The <b>next</b> button on top of the screen will be unlocked once you complete the objectives. Good luck!
    </p>
  </div>
  <div class="work" style="height:460px">
    <script type="text/hyperscript">
      workbench.renderMaquette()
    </script>
  </div>
  {% include analytics.html %}
</body>
</html>
