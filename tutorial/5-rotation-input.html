<!doctype html>
<html>
  <head>
    <title>Tutorial</title>
    <link href="tutorial.css" rel="stylesheet" />
    <script src="bower_components/maquette/dist/maquette.min.js"></script>
    <script src="bower_components/ace-builds/src-noconflict/ace.js"></script>
    <script src="components/markup-matcher.js"></script>
    <script src="components/workbench.js"></script>
    <script src="components/navigation.js"></script>
    <style>
      li.complete {
        background-color: green;
      }
    </style>
    <script>
      document.addEventListener('DOMContentLoaded', function () {

        var h = maquette.h;

        // Renders the virtual DOM
        var render = function () {
          return h("div.projector", [
            workbench.renderMaquette(),
            navigation.renderMaquette()
          ]);

        };

        // Starts the projector, which renders the virtual DOM at the right moments
        var projector = maquette.createProjector(document.querySelector(".projector"), render, {});

        var achieved1 = false;
        var objective1 = {
          title: "Assign the rotation variable to the value property of the input",
          isAchieved: function () {
            return achieved1;
          },
          onSceneUpdate: function (contentWindow) {
            var oldRotation = contentWindow.rotation;
            contentWindow.rotation = 76908;
            try {
              achieved1 = false;
              var vnode = contentWindow.renderMaquette();
              var input = vnode.children[0].children[0].children[0].children[1];
              achieved1 = input.properties.value == contentWindow.rotation;
            } catch (e) {
            }
            contentWindow.rotation = oldRotation;
          },
          renderMaquette: function () {
            return h("p", ["Hint: Use the properties parameter of the h() function."]);
          }
        };

        var achieved2 = false;
        var objective2 = {
          title: "Assign the handleRotationInput function to the oninput property",
          isAchieved: function () {
            return achieved2;
          },
          onSceneUpdate: function (contentWindow) {
            try {
              achieved2 = false;
              var vnode = contentWindow.renderMaquette();
              var input = vnode.children[0].children[0].children[0].children[1];
              achieved2 = contentWindow.handleRotationInput && (input.properties.oninput === contentWindow.handleRotationInput);
            } catch (e) {
            }
          },
          renderMaquette: function () {
            return h("p", []);
          }
        };

        var achieved3 = false;
        var objective3 = {
          title: "Take the flying saucer for a testdrive",
          isAchieved: function () {
            return achieved3;
          },
          onSceneUpdate: function (contentWindow) {
            achieved3 = false;
            try {
              achieved3 = (contentWindow.rotation === "360" && workbench.getScript().indexOf("360") === -1);
            } catch(e) {
            }
          },
          renderMaquette: function () {
            return h("p", ["Rotate the flying saucer 360 degrees using the remote control"]);
          }
        };

        var workbench = createWorkbench(projector, "assets/saucer-rotation-input.js", [
          objective1,
          objective2,
          objective3
        ]);
        var navigation = createNavigation(projector, "4-input.html", "6-how-it-works.html", workbench.allObjectivesAchieved);
      });
    </script>
  </head>
<body>
  <div class="projector"></div>
</body>
</html>
